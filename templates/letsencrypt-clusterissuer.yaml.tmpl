apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-${vars.name}
spec:
  acme:
    email: ${vars.acme_email}
    privateKeySecretRef:
      name: letsencrypt-${vars.name}
    server: ${vars.server}
    solvers:
    - dns01:
        cloudflare:
          apiTokenSecretRef:
            key: cloudflare-token
            name: cloudflare-token-secret
          email: ${vars.acme_email}
      selector:
        dnsZones:
        - ${vars.base_public_domain}
